---
title: "plotting only cells with gene"
output: html_document
date: "2024-05-21"
---
Installation of packages and loading of data 
```{r setup, include=FALSE}
library(SpatialExperiment)
library(ggspavis)
library(STexampleData)
library(zellkonverter)
library(RColorBrewer)

fp_chuvio_L1_1 <- "/work/PRTNR/CHUV/DIR/rgottar1/spatial/env/astear/data/rcd_annot/chuvio_L1_1_RCTD_lvl3.h5ad"
fp_chuvio_L1_2 <- "/work/PRTNR/CHUV/DIR/rgottar1/spatial/env/astear/data/rcd_annot/chuvio_L1_2_RCTD_lvl3.h5ad"
fp_chuvio_L2_1 <- "/work/PRTNR/CHUV/DIR/rgottar1/spatial/env/astear/data/rcd_annot/chuvio_L2_1_RCTD_lvl3.h5ad"
fp_chuvio_L3_1 <- "/work/PRTNR/CHUV/DIR/rgottar1/spatial/env/astear/data/rcd_annot/chuvio_L3_1_RCTD_lvl3.h5ad"
fp_chuvio_L4_1 <- "/work/PRTNR/CHUV/DIR/rgottar1/spatial/env/astear/data/rcd_annot/chuvio_L4_1_RCTD_lvl3.h5ad"


# Use the readH5AD function with the specified file path
chuvio_L1_1 <- readH5AD(fp_chuvio_L1_1)
chuvio_L1_2 <- readH5AD(fp_chuvio_L1_2)
chuvio_L2_1 <- readH5AD(fp_chuvio_L2_1)
chuvio_L3_1 <- readH5AD(fp_chuvio_L3_1)
chuvio_L4_1 <- readH5AD(fp_chuvio_L4_1)
```

## Spatial distribution the logcount of cells with gene of interst expressed

First we create a object with only the logcount to make sure we aren't plotting the raw gene count

```{r sample2 with logcount}
#Testing

sample2 <- SingleCellExperiment(assays = list(counts = counts_matrix))

# Transfer relevant metadata and colData from 'sample' to 'sample2'
metadata(sample2) <- metadata(sample)
colData(sample2) <- colData(sample)
rowData(sample2) <- rowData(sample)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
